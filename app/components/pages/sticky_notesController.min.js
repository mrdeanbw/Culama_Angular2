angular.module("altairApp").controller("sticky_notesCtrl",["$rootScope","$scope","$window","$timeout",function($rootScope,$scope,$window,$timeout){function checklist_item_add(){""!=$scope.note_form.checklist_item_title&&($scope.note_form.checklist.push({id:$scope.randID_generator(),title:$scope.note_form.checklist_item_title}),$scope.note_form.checklist_item_title="")}$rootScope.toBarActive=!0,$rootScope.noteFormActive=!1,$scope.$on("$destroy",function(){$rootScope.toBarActive=!1,$rootScope.noteFormActive=!1}),$scope.randID_generator=function(){var randLetter=String.fromCharCode(65+Math.floor(26*Math.random()));return randLetter+Date.now()},$scope.notes_labels=[{text:"label 1",text_safe:"label-1",type:"default"},{text:"label 2",text_safe:"label-2",type:"warning"},{text:"label 3",text_safe:"label-3",type:"danger"},{text:"label 4",text_safe:"label-4",type:"success"},{text:"label 5",text_safe:"label-5",type:"primary"}],$scope.notes_temp=[{time:14756046e5,color:"md-bg-red-100",title:"Lorem impsum dolor sit",content:"Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aliquam molestias quidem repellendus saepe vero! Assumenda fugiat perferendis reiciendis repellat voluptas?",labels:[{type:"primary",text:"label 5",text_safe:"label-5"}]},{time:1475691265322,title:"Lorem ipsum",content:"Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aliquam molestias quidem repellendus saepe vero!",labels:[{type:"default",text:"label 1",text_safe:"label-1"}],checklist:[{checked:!1,title:"first item"},{checked:!0,title:"second item"},{checked:!1,title:"third item"},{checked:!1,title:"fourth item"}]},{time:1475691265322,color:"md-bg-green-100",title:"Lorem ipsum dolor sit amet, consectetur adipisicing elit",content:"Lorem ipsum dolor sit amet, consectetur adipisicing elit. Assumenda fugiat perferendis reiciendis repellat voluptas?",labels:[{type:"warning",text:"label 2",text_safe:"label-2"},{type:"danger",text:"label 3",text_safe:"label-3"}]},{time:14756046e5,color:"md-bg-yellow-100",title:"Lorem impsum dolor sit",content:"Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aliquam molestias quidem repellendus saepe vero! Assumenda fugiat perferendis reiciendis repellat voluptas?",labels:[{type:"success",text:"label 4",text_safe:"label-4"},{type:"primary",text:"label 5",text_safe:"label-5"}]}],$scope.notes=[],angular.forEach($scope.notes_temp,function(value,key){$scope.notes.push(value);var filters="";angular.forEach(value.labels,function(val,k){var delimeter=k>0?",":"";filters+=delimeter+val.text_safe}),$scope.notes[key].filterBy=filters}),$scope.closeNote=function($event,index){$event.preventDefault();var $this_note=$($event.currentTarget).closest(".md-card").parent();$this_note.addClass("uk-animation-scale-up uk-animation-reverse"),$timeout(function(){$scope.notes[index].hidden=!0},300)},$scope.showNoteForm=function($event){$event.preventDefault(),$rootScope.noteFormActive=!0},$scope.color_picker=function(object,pallete){function replaceColor(color){if(color){var replaceColor=color.split("-"),lastEl=replaceColor[replaceColor.length-1];if(isNaN(lastEl))var replacedColor=replaceColor.join("-");else{replaceColor.pop();var replacedColor=replaceColor.join("-")+"-100"}return replacedColor}return!1}if(object){for(var cp_id="cp_1",cp_pallete=pallete?pallete:["md-bg-white","md-bg-red-500","md-bg-pink-500","md-bg-purple-500","md-bg-indigo-500","md-bg-blue-500","md-bg-cyan-500","md-bg-teal-500","md-bg-green-500","md-bg-lime-500","md-bg-yellow-500","md-bg-amber-500","md-bg-brown-500","md-bg-blue-grey-500"],cp_pallete_length=cp_pallete.length,cp_wrapper=$('<div class="cp_altair" id="'+cp_id+'"/>'),$i=0;$i<cp_pallete_length;$i++){var span="md-bg-"==cp_pallete[$i].substring(0,6)?"<span data-color="+cp_pallete[$i]+' class="'+cp_pallete[$i]+'"></span>':"<span data-color="+cp_pallete[$i]+' style="background:'+cp_pallete[$i]+'"></span>';cp_wrapper.append(span)}return $("body").on("click","#"+cp_id+" span",function(){$(this).addClass("active_color").siblings().removeClass("active_color"),$scope.note_form.color=replaceColor($(this).attr("data-color")),"function"==typeof callback&&callback.call(this)}),object.append(cp_wrapper)}},$scope.noteColorPicker=$scope.color_picker($('<div id="calendar_colors_wrapper"></div>')).prop("outerHTML"),$scope.note_form={title:"",content:"",checklist:[]},$scope.checkboxAddClick=function($event){$event.preventDefault(),checklist_item_add()},$scope.checkboxAddKey=function($event){var key=$event.which||$event.keyCode;13==key&&checklist_item_add()},$scope.noteAdd=function($event){$event.preventDefault();var $title_input=$("#note_f_title"),$content_input=$("#note_f_content");if($title_input.removeClass("md-input-danger"),$content_input.removeClass("md-input-danger"),""==$scope.note_form.title)return void $title_input.addClass("md-input-danger").focus();if(""==$scope.note_form.content)return void $content_input.addClass("md-input-danger").focus();var labels=[];angular.forEach($scope.notes_labels,function(value,key){value.checked&&labels.push(value)});var filter="";labels&&angular.forEach(labels,function(val,k){var delimeter=k>0?",":"";filter+=delimeter+val.text_safe}),$scope.notes.push({time:(new Date).getTime(),color:$scope.note_form.color,title:$scope.note_form.title,content:$scope.note_form.content.replace(/\n/g,"<br />"),labels:labels,checklist:$scope.note_form.checklist,filterBy:filter}),$timeout(function(){$scope.note_form={title:"",content:"",checklist:[]},$rootScope.noteFormActive=!1,angular.forEach($scope.notes_labels,function(value,key){value.checked=!1})})},$scope.clearForm=function($event){$event.preventDefault(),$scope.note_form={title:"",content:"",checklist:[]},angular.forEach($scope.notes_labels,function(value,key){value.checked=!1}),$("#cp_1").find(".active_color").removeClass("active_color")}}]);